<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>NeGot Prototype</title>
    <link rel="stylesheet" href="/ui/styles/main.css" />
  </head>
  <body>
    <div class="app">
      <aside class="nav">
        <div class="brand">
          <div class="logo">NeGot</div>
          <div class="subtitle">Agentic Negotiation Simulator</div>
        </div>
        <nav>
          <button class="nav-link" data-target="case">Case Setup</button>
          <button class="nav-link" data-target="counterparty">Counterparty</button>
          <button class="nav-link" data-target="simulate">Simulate</button>
          <button class="nav-link" data-target="insights">Insights</button>
          <button class="nav-link" data-target="strategies">Strategies (Advanced)</button>
          <div class="toggle">
            <label>
              <input type="checkbox" id="debugToggle" />
              Debug Mode
            </label>
          </div>
          <button class="nav-link" data-target="debug" id="debugNav" hidden>Debug</button>
        </nav>
      </aside>

      <main class="content">
        <section id="case" class="panel active">
          <h1>Case Setup</h1>
          <div class="panel-grid">
            <div>
              <label>Topic <span class="hint-icon" data-tooltip="Describe the real-world situation and what is being negotiated.">?</span></label>
              <textarea id="topic" rows="2" placeholder="Describe the negotiation topic"></textarea>
            </div>
            <div class="row">
              <div>
                <label>Domain <span class="hint-icon" data-tooltip="Sets the negotiation type and shapes the agent prompts.">?</span></label>
                <select id="domain">
                  <option value="GENERAL">GENERAL</option>
                  <option value="JOB_OFFER_COMP">JOB_OFFER_COMP</option>
                  <option value="RENT_HOUSING">RENT_HOUSING</option>
                  <option value="PROCUREMENT_VENDOR">PROCUREMENT_VENDOR</option>
                  <option value="SERVICES_CONTRACTOR">SERVICES_CONTRACTOR</option>
                </select>
              </div>
              <div>
                <label>Channel <span class="hint-icon" data-tooltip="How the negotiation happens (email, in-person, DM, etc.).">?</span></label>
                <select id="channel">
                  <option value="UNSPECIFIED">UNSPECIFIED</option>
                  <option value="IN_PERSON">IN_PERSON</option>
                  <option value="EMAIL">EMAIL</option>
                  <option value="DM">DM</option>
                </select>
              </div>
            </div>

            <div class="section">
              <div class="section-header">
                <h2>Issues (User) <span class="hint-icon" data-tooltip="The items you care about and want to maximize or minimize.">?</span></h2>
                <button id="addUserIssue" type="button">Add User Issue</button>
              </div>
              <div class="editor-grid" id="userIssuesEditor"></div>
            </div>

            <div class="section">
              <div class="section-header">
                <h2>Issues (Counterparty) <span class="hint-icon" data-tooltip="The items the other side cares about (as you understand them).">?</span></h2>
                <button id="addCounterpartyIssue" type="button">Add Counterparty Issue</button>
              </div>
              <div class="editor-grid" id="counterpartyIssuesEditor"></div>
            </div>

            <div class="section">
              <div class="section-header">
                <h2>Objectives <span class="hint-icon" data-tooltip="Your target outcome and minimum acceptable outcome.">?</span></h2>
                <div class="inline-field">
                  <label>Objective Type <span class="hint-icon" data-tooltip="Choose a single overall target or a per-issue target/reservation.">?</span></label>
                  <select id="objectiveType">
                    <option value="OFFER_VECTOR">OFFER_VECTOR</option>
                    <option value="SINGLE_VALUE">SINGLE_VALUE</option>
                  </select>
                </div>
              </div>
              <div id="objectiveVectorSection" class="editor-grid"></div>
              <div id="objectiveSingleSection" class="editor-grid" hidden>
                <div class="editor-row single-row">
                  <div>
                    <label>Target value <span class="hint-icon" data-tooltip="Your ideal outcome if everything goes well.">?</span></label>
                    <input type="text" id="objectiveTargetSingle" />
                  </div>
                  <div>
                    <label>Reservation value <span class="hint-icon" data-tooltip="Your minimum acceptable outcome before you walk away.">?</span></label>
                    <input type="text" id="objectiveReservationSingle" />
                  </div>
                </div>
              </div>
            </div>

            <div class="section">
              <div class="section-header">
                <h2>Parameters <span class="hint-icon" data-tooltip="Constraints or preferences that guide the user's behavior.">?</span></h2>
                <button id="addParameter">Add Parameter</button>
              </div>
              <div class="editor-grid" id="parametersEditor"></div>
            </div>

            <div class="actions">
              <select id="sampleCaseSelect" aria-label="Sample case"></select>
              <button id="loadSample">Load Sample Case</button>
              <select id="savedCaseSelect" aria-label="Saved case" multiple size="4"></select>
              <button id="loadSavedCase">Load Saved Case</button>
              <button id="deleteSavedCases">Delete Selected</button>
              <button id="createCase" class="primary">Create Case</button>
              <button id="validateCase">Validate</button>
            </div>
            <div class="status" id="caseStatus">No case created.</div>
          </div>
        </section>

        <section id="counterparty" class="panel">
          <h1>Counterparty</h1>
          <div class="panel-grid">
            <div class="row">
              <div>
                <label>Policy Rigidity</label>
                <select id="policyRigidity">
                  <option value="unknown" selected>I don't know</option>
                  <option value="low">Low</option>
                  <option value="medium">Medium</option>
                  <option value="high">High</option>
                </select>
                <div class="hint" data-control-id="policy_rigidity">
                  <div class="hint-definition"></div>
                  <div class="hint-example"></div>
                </div>
              </div>
              <div>
                <label>Cooperativeness</label>
                <select id="cooperativeness">
                  <option value="unknown" selected>I don't know</option>
                  <option value="low">Low</option>
                  <option value="medium">Medium</option>
                  <option value="high">High</option>
                </select>
                <div class="hint" data-control-id="cooperativeness">
                  <div class="hint-definition"></div>
                  <div class="hint-example"></div>
                </div>
              </div>
            </div>
            <div class="row">
              <div>
                <label>Time Pressure</label>
                <select id="timePressure">
                  <option value="unknown" selected>I don't know</option>
                  <option value="low">Low</option>
                  <option value="medium">Medium</option>
                  <option value="high">High</option>
                </select>
                <div class="hint" data-control-id="time_pressure">
                  <div class="hint-definition"></div>
                  <div class="hint-example"></div>
                </div>
              </div>
              <div>
                <label>Authority Clarity</label>
                <select id="authorityClarity">
                  <option value="unknown" selected>I don't know</option>
                  <option value="low">Low</option>
                  <option value="medium">Medium</option>
                  <option value="high">High</option>
                </select>
                <div class="hint" data-control-id="authority_clarity">
                  <div class="hint-definition"></div>
                  <div class="hint-example"></div>
                </div>
              </div>
            </div>
            <div class="actions">
              <button id="calibratePersona" class="primary">Calibrate Persona</button>
            </div>
            <pre id="personaDistribution" class="output"></pre>
            <div class="status" id="counterpartyHintStatus"></div>
          </div>
        </section>

        <section id="simulate" class="panel">
          <h1>Simulate</h1>
          <div class="panel-grid">
            <div class="row">
              <div>
                <label>Runs</label>
                <input type="number" id="runs" min="1" value="1" />
              </div>
              <div>
                <label>Max Turns</label>
                <input type="number" id="max_turns" min="1" value="8" />
              </div>
            </div>
            <div class="actions">
              <button id="runSim" class="primary">Run Simulations</button>
            </div>
            <div id="runProgress" class="status"></div>
            <div id="runProgressMeta" class="status"></div>
            <div class="table" id="runsTable"></div>
          </div>
        </section>

        <section id="insights" class="panel">
          <h1>Insights</h1>
          <div class="panel-grid">
            <div class="insights-toolbar">
              <button id="loadInsights" class="primary">Load Insights</button>
              <div id="insightsStatus" class="status"></div>
            </div>
            <div class="insights-grid" id="insightsSummary"></div>
            <div class="insights-section">
              <h2>Outcome Distribution</h2>
              <div class="bar-chart" id="outcomeChart"></div>
            </div>
            <div class="insights-buckets" id="insightsBuckets">
              <div class="insights-section split triple" id="insightsColumns">
                <div class="insights-column" data-bucket="PASS">
                  <h2>PASS Insights</h2>
                  <div class="insight-list" id="bucketPass"></div>
                </div>
                <div class="insights-column" data-bucket="NEUTRAL">
                  <h2>NEUTRAL Insights</h2>
                  <div class="insight-list" id="bucketNeutral"></div>
                </div>
                <div class="insights-column" data-bucket="FAIL">
                  <h2>FAIL Insights</h2>
                  <div class="insight-list" id="bucketFail"></div>
                </div>
              </div>
              <aside class="insight-detail" id="insightDetail" hidden>
                <div class="insight-detail-header">
                  <button id="closeInsightDetail">Back to insights</button>
                  <div class="insight-detail-title" id="insightDetailTitle"></div>
                  <div class="insight-detail-meta" id="insightDetailMeta"></div>
                </div>
                <div class="insight-detail-controls">
                  <label>Example runs</label>
                  <select id="insightRunSelect"></select>
                </div>
                <div class="insight-detail-snippets" id="insightDetailSnippets"></div>
                <div class="conversation" id="insightConversation"></div>
              </aside>
            </div>
            <details class="insights-raw">
              <summary>Raw Insights JSON</summary>
              <pre id="insightsOutput" class="output"></pre>
            </details>
          </div>
        </section>

        <section id="strategies" class="panel">
          <h1>Strategies (Advanced)</h1>
          <div class="panel-grid">
            <div class="actions">
              <button id="loadStrategies">Refresh Strategies</button>
            </div>
            <div id="strategyGrid" class="card-grid"></div>
          </div>
        </section>

        <section id="debug" class="panel">
          <h1>Debug</h1>
          <div class="panel-grid">
            <button id="loadTrace" class="primary">Load Latest Trace</button>
            <div class="section">
              <h2>Agent Flow</h2>
              <div id="traceFlow" class="trace-flow"></div>
            </div>
            <pre id="traceOutput" class="output"></pre>
          </div>
        </section>
      </main>
    </div>

    <script src="/ui/app.js"></script>
  </body>
</html>
